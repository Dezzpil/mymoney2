#!/usr/bin/env node

const readline = require('readline');
const MongoConnectorFn = require('../src/MongoConnectorFn.js');
const PurchaseSaver = require('../src/PurchaseSaver.js');

const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

const connector = new MongoConnectorFn();
const saver = new PurchaseSaver();

rl.on('line', (line) => {
    let trimmed = line.trim();
    switch (trimmed) {
        case 'q':
        case 'quit':
            rl.close();
            connector.close();
            break;

        default:
            saver.setInput(trimmed).saveFn(connector, (err, result) => {
                err ? console.error(err) : console.log(result);
            });
            break;
    }
    rl.prompt();
});

console.log('Purchase input. Input `q` or `quit` when done');
